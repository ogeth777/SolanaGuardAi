(()=>{var e={};e.id=130,e.ids=[130],e.modules={30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},6005:e=>{"use strict";e.exports=require("node:crypto")},41041:e=>{"use strict";e.exports=require("node:url")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},88655:()=>{},18245:()=>{},64080:(e,t,r)=>{"use strict";r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>f});var o={};r.r(o),r.d(o,{POST:()=>u});var s=r(95419),i=r(69108),a=r(99678),n=r(78070),l=r(78456);async function u(e){try{let t=await e.json();console.log("API /scan received body:",t);let{address:r}=t;if(!r)return n.Z.json({error:"Address is required"},{status:400});let o=await (0,l.w)(r);return n.Z.json(o)}catch(e){return console.error("API /scan error:",e),n.Z.json({error:e.message||"Failed to scan token"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/scan/route",pathname:"/api/scan",filename:"route",bundlePath:"app/api/scan/route"},resolvedPagePath:"Z:\\VibeCode\\Code\\WORK\\solana-guard-ai\\app\\api\\scan\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:m,headerHooks:h,staticGenerationBailout:f}=c,y="/api/scan/route";function g(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}},78456:(e,t,r)=>{"use strict";r.d(t,{T:()=>u,w:()=>d});var o=r(235),s=r(71900),i=r(71242),a=r(46992);let n=[process.env.NEXT_PUBLIC_SOLANA_RPC_URL,"https://api.mainnet-beta.solana.com","https://solana-rpc.publicnode.com"].filter(Boolean),l=["1nc1nerator11111111111111111111111111111111","QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ","DeadInfo11111111111111111111111111111111111","0x000000000000000000000000000000000000dEaD"];async function u(e){try{let t,r;let o=new AbortController,s=setTimeout(()=>o.abort(),5e3),i=await fetch(`https://api.dexscreener.com/latest/dex/tokens/${e}`,{signal:o.signal});if(clearTimeout(s),!i.ok)return null;let a=await i.json();if(!a.pairs||0===a.pairs.length)return null;let n=a.pairs.filter(t=>t.baseToken.address===e).sort((e,t)=>(t.liquidity?.usd||0)-(e.liquidity?.usd||0))[0];if(n||(n=a.pairs.sort((e,t)=>(t.liquidity?.usd||0)-(e.liquidity?.usd||0))[0]),!n)return null;let l=n.baseToken.address===e,u=l?n.baseToken:n.quoteToken,c=0;if(l)c=parseFloat(n.priceUsd||"0");else{let e=parseFloat(n.priceUsd||"0"),t=parseFloat(n.priceNative||"0");t>0&&(c=e/t)}for(let e of a.pairs)if(e.info?.websites){let r=e.info.websites.find(e=>e.url.includes("coinmarketcap.com")),o=e.info.websites.find(e=>e.url.includes("coingecko.com"));if(r){t=r.url;break}o&&!t&&(t=o.url)}return!t&&(n.liquidity?.usd||0)>1e3&&(r=`https://www.google.com/search?q=site:coinmarketcap.com+${u.name}+${u.symbol}+crypto`),{name:u.name,symbol:u.symbol,imageUrl:n.info?.imageUrl,priceUsd:c,liquidityUsd:n.liquidity?.usd||0,fdv:n.fdv||0,pairAddress:n.pairAddress,dexId:n.dexId,volume24h:n.volume?.h24||0,websites:n.info?.websites||[],socials:n.info?.socials||[],buys24h:n.txns?.h24?.buys||0,sells24h:n.txns?.h24?.sells||0,priceChange24h:n.priceChange?.h24||0,externalUrl:t,searchUrl:r}}catch(e){return console.warn("DexScreener fetch failed:",e),null}}async function c(e,t){console.log(`Trying RPC: ${t}`);try{let r=new o.ew(t,{commitment:"confirmed",disableRetryOnRateLimit:!0}),s=new o.nh(e),i=new Promise((e,t)=>setTimeout(()=>t(Error("RPC Timeout")),3e3)),a=await Promise.race([r.getParsedAccountInfo(s),i]);return{connection:r,mintInfo:a,pubKey:s}}catch(e){throw e}}async function d(e){console.log(`Analyzing token: ${e}`);let t=null,r=null,o=null,d=null;for(let s of n)try{let i=await c(e,s);if(i.mintInfo.value){t=i.connection,r=i.mintInfo,o=i.pubKey,console.log(`Connected via ${s}`);break}throw Error("Token not found on this RPC")}catch(e){console.warn(`Failed RPC ${s}:`,e.message),d=e}if(!t||!r||!o)throw Error(d?.message||"Failed to connect to Solana network or Token not found.");try{let n=r.value.data.parsed?.info;if(!n)throw console.error("Not a valid SPL token"),Error("Address is not a valid SPL Token Mint.");let c=n.mintAuthority,d=n.freezeAuthority,p=parseFloat(n.supply),m=n.decimals;console.log(`Mint Info: Supply=${p}, MintAuth=${c}`),console.log("Fetching top holders...");let h=[];try{let e=new Promise((e,t)=>setTimeout(()=>t(Error("Top Holders Timeout")),5e3));h=(await Promise.race([t.getTokenLargestAccounts(o),e])).value.slice(0,10).map(e=>({address:e.address.toString(),amount:e.uiAmount||0,percentage:(e.uiAmount||0)/(p/Math.pow(10,m))*100}))}catch(e){console.warn("Failed to fetch top holders (might be empty or new token):",e)}console.log("Fetching market data...");let f=await u(e);if(f){let e=h.filter(e=>l.includes(e.address)).reduce((e,t)=>e+t.amount,0),t=p-e,r=f.priceUsd*t;f.circulatingSupply=t,f.marketCap=r,f.volToMktCap=r>0?f.volume24h/r:0}console.log("Fetching Metaplex metadata...");let y=null;try{let r=(0,s.i)(t.rpcEndpoint),o=(0,i.findMetadataPda)(r,{mint:(0,a.ZL)(e)}),n=new Promise((e,t)=>setTimeout(()=>t(Error("Metaplex Timeout")),5e3));y=(await Promise.race([(0,i.fetchMetadata)(r,o),n])).isMutable}catch(e){console.warn("Failed to fetch Metaplex metadata (might be a vanilla SPL token):",e),y=null}let g=0,Q=!1;f&&f.liquidityUsd>1e3&&f.buys24h>10&&0===f.sells24h&&(Q=!0,g+=90);let w=h.some(e=>l.includes(e.address));w&&(g-=20),c&&(g+=50),d&&(g+=30),y&&(g+=10),(h[0]?.percentage||0)>50&&!w&&(g+=20),f&&f.liquidityUsd<1e3&&(g+=40),f||(g+=10),g=Math.min(g,100);let b="SAFE";return g>30&&(b="CAUTION"),g>70&&(b="HIGH RISK"),Q&&(b="SCAM (HONEYPOT)"),{address:e,isValid:!0,mintAuthority:c,freezeAuthority:d,supply:p,decimals:m,isMintable:!!c,isFreezable:!!d,isMutable:y,isLpBurned:w,isHoneypot:Q,topHolders:h,marketData:f||void 0,riskScore:g,verdict:b}}catch(e){throw console.error("Error in analyzeToken:",e),Error(e.message||"Failed to analyze token.")}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,617],()=>r(64080));module.exports=o})();